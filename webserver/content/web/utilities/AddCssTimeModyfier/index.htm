<!DOCTYPE html>
<html manifest="media.appcache">
    <head>
        <script>
            
            window.addEventListener('error', function(e) {
                window.top.postMessage("[BOOT-RELOAD]", '*');
            }, true);
            
        </script>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <title>RPlayer (min v1.42.61) :: Utility - AddCssTimeModyfier v0.0.1 (2022)</title>

        <link rel="icon" href="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4NCjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+DQo8IS0tIENyZWF0b3I6IENvcmVsRFJBVyAyMDE4ICg2NCBiaXTFrykgLS0+DQo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjIxMG1tIiBoZWlnaHQ9IjIxMG1tIiB2ZXJzaW9uPSIxLjEiIHN0eWxlPSJzaGFwZS1yZW5kZXJpbmc6Z2VvbWV0cmljUHJlY2lzaW9uOyB0ZXh0LXJlbmRlcmluZzpnZW9tZXRyaWNQcmVjaXNpb247IGltYWdlLXJlbmRlcmluZzpvcHRpbWl6ZVF1YWxpdHk7IGZpbGwtcnVsZTpldmVub2RkOyBjbGlwLXJ1bGU6ZXZlbm9kZCINCnZpZXdCb3g9IjAgMCAyMTAwMCAyMTAwMCINCiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+DQogPGRlZnM+DQogIDxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+DQogICA8IVtDREFUQVsNCiAgICAuc3RyMSB7c3Ryb2tlOiMyQjJBMjk7c3Ryb2tlLXdpZHRoOjIwO3N0cm9rZS1taXRlcmxpbWl0OjIyLjkyNTZ9DQogICAgLnN0cjAge3N0cm9rZTpibGFjaztzdHJva2Utd2lkdGg6MjA7c3Ryb2tlLW1pdGVybGltaXQ6MjIuOTI1Nn0NCiAgICAuZmlsMSB7ZmlsbDpibGFja30NCiAgICAuZmlsMiB7ZmlsbDojNDE4M0M0fQ0KICAgIC5maWwwIHtmaWxsOndoaXRlfQ0KICAgXV0+DQogIDwvc3R5bGU+DQogPC9kZWZzPg0KIDxnIGlkPSJWcnN0dmFfeDAwMjBfMSI+DQogIDxtZXRhZGF0YSBpZD0iQ29yZWxDb3JwSURfMENvcmVsLUxheWVyIi8+DQogIDxnIGlkPSJMb2dvX3gwMDIwX1JQbGF5ZXIiPg0KICAgPHJlY3QgY2xhc3M9ImZpbDAiIHdpZHRoPSIyMTAwMCIgaGVpZ2h0PSIyMTAwMCIgcng9IjI5NzMuOTYiIHJ5PSIyOTczLjk2Ii8+DQogICA8ZyBpZD0iTG9nb194MDAyMF9SUGxheWVyX3gwMDIwXzEiPg0KICAgIDxwYXRoIGNsYXNzPSJmaWwxIiBkPSJNNjQ1MC40OCAxMjEwMy43bDY3MC44MyAtMzg3LjMgNzg4MS4yOCAtNDU1MC4yNmMxNDkuNDYsLTg2LjI5IDIzNSwtMjM0LjQ1IDIzNSwtNDA3LjAzIDAsLTE3Mi41OCAtODUuNTQsLTMyMC43NCAtMjM1LC00MDcuMDNsLTg1NTIuMTEgLTQ5MzcuNTZjLTE0OS40NiwtODYuMjkgLTMyMC41NCwtODYuMjkgLTQ3MCwwIC0xNDkuNDUsODYuMjkgLTIzNSwyMzQuNDUgLTIzNSw0MDcuMDNsMCA5ODc1LjExYzAsMTcyLjU4IDg1LjU0LDMyMC43NSAyMzUsNDA3LjA0IDE0OS40Niw4Ni4yOCAzMjAuNTQsODYuMjkgNDcwLDB6bTY3MC44MyAtMjU3Ny4xOWwwIC01NTM0LjggMCAtODE0LjA2IDcwNC44MSA0MDYuOTIgMjM5Ni44MyAxMzgzLjgxIDMxMDEuNjMgMTc5MC43MyAtMzEwMS42MyAxNzkwLjczIC0yMzk2LjgzIDEzODMuODEgLTcwNC44MSA0MDYuOTIgMCAtODE0LjA2eiIvPg0KICAgIDxwYXRoIGNsYXNzPSJmaWwxIiBkPSJNNjIxNS40OCAxMjc4NS43N2w0MzUuODMgMGMyNTguODcsMCA0NzAsMjExLjEzIDQ3MCw0NzBsMCA2MDE0LjIxYzAsMjU4Ljg3IC0yMTEuMTMsNDcwIC00NzAsNDcwbC00MzUuODMgMGMtMjU4Ljg3LDAgLTQ3MCwtMjExLjEzIC00NzAsLTQ3MGwwIC02MDE0LjIxYzAsLTI1OC44NyAyMTEuMTMsLTQ3MCA0NzAsLTQ3MHoiLz4NCiAgICA8cGF0aCBjbGFzcz0iZmlsMSBzdHIwIiBkPSJNOTg3Mi45NyAxOTI2OS45OGwwIC02MDE0LjIxYzAsLTI1OC44NyAyMTEuMTMsLTQ3MCA0NzAsLTQ3MGw0MzUuODMgMGMyNTguODcsMCA0NzAsMjExLjEzIDQ3MCw0NzBsMCA2MDE0LjIxYzAsMjU4Ljg3IC0yMTEuMTMsNDcwIC00NzAsNDcwbC00MzUuODMgMGMtMjU4Ljg3LDAgLTQ3MCwtMjExLjEzIC00NzAsLTQ3MHoiLz4NCiAgICA8cG9seWdvbiBjbGFzcz0iZmlsMiBzdHIxIiBwb2ludHM9IjcxMjEuMzEsMzk5MS43MSA3MTIxLjMxLDk1MjYuNTEgNzEyMS4zMSwxMDM0MC41NyA3ODI2LjEyLDk5MzMuNjUgMTAyMjIuOTUsODU0OS44NCAxMzMyNC41OCw2NzU5LjExIDEwMjIyLjk1LDQ5NjguMzggNzgyNi4xMiwzNTg0LjU3IDcxMjEuMzEsMzE3Ny42NSAiLz4NCiAgIDwvZz4NCiAgPC9nPg0KIDwvZz4NCjwvc3ZnPg0K">
        
        <link rel="stylesheet" href="../../vendor/semantic/ui/dist/semantic.css">
        
        <script src="../../src/js/foreign/jquery.js"></script>
        <script src="../../src/js/foreign/jquery.transit.min.js"></script>
        <script src="../../src/js/foreign/current-device.js"></script>
        <script src="../../vendor/stuk/jszip/dist/jszip.min.js"></script>
        <script src="../../vendor/stuk/jszip/vendor/FileSaver.js"></script>
        <script src="../../vendor/semantic/ui/dist/semantic.min.js"></script>
        <script src="../../vendor/robinherbots/jquery.inputmask/dist/jquery.inputmask.min.js"></script>
        <script src="../../src/js/foreign/jquery.fullscreen.min.js"></script>
        <style>
            body {
                position: fixed;
                display: flex;
                justify-content: center;
                align-items: center;
                top: 0;
                right: 0;
                bottom: 0;
                left: 0;
            }

            .leftSide,
            .rightSide,
            .middleSide {
                display: flex !important;
                justify-content: center;
                align-items: center;
                background-color: #123;
            }

            .layout {
                position: fixed;
                width: 100% !important;
                height: 100% !important;
            }

            .leftSide textarea,
            .rightSide textarea {
                width: 100% !important;
                min-width: none !important;
                height: 100% !important;
                max-height: none !important;
                resize: none !important;
            }

            input[type='text'] {
                margin: .25em 0 .25em 0 !important;
            }
        </style>
    </head>
    <body>
        <form class="ui form three columns stackable grid layout" id="mainForm">
            <div class="seven wide column leftSide">
                <textarea placeholder="rplayer.conf.js >> object cssTimeModyfier" class="form-control sourceCode" wrap="hard" name="source"></textarea>
            </div>
            <div class="two wide column middleSide">
                <div>
                    <input type="text" name="cssFx" class="form-control cssFx" placeholder="CSS key">
                    <input type="text" name="cssSelector" class="form-control cssSelector" placeholder="CSS selector">
                    <input type="text" name="offset" class="form-control offset" placeholder="Data offset [ms]">
                </div>
            </div>
            <div class="seven wide column rightSide">
                <textarea placeholder='[{"TimeMs": <int>,"LengthMs": <int>}, ...]' class="form-control addCode" wrap="hard" name="add"></textarea>
            </div>
        </form>
    </body>
    <script type="text/ecmascript">
        /**
         * @file AddCssTimeModyfier utility for RPlayer web application
         * @copyright Robert Rajs 2022
         * @author Robert Rajs
         * @see {@link https://rajs.info|Home}
         * @see {@link https://zesilovac.cz|Zesilovač}
         * @see {@link https://bandzone.cz/rajs|Bandzone}
         * @see {@link https://technotramp.com|Technotramp}
         * @see {@link https://github.com/entlaabstudio/rplayer|GitHub}
         * @see {@link https://cs-cz.facebook.com/robert.rajs.9|Facebook}
         * @license
         * Copyright (c) 2022 Robert Rajs
         * 
         * Permission is hereby granted, free of charge, to any person obtaining a copy
         * of this software and associated documentation files (the "Software"), to deal
         * in the Software without restriction, including without limitation the rights
         * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
         * copies of the Software, and to permit persons to whom the Software is
         * furnished to do so, subject to the following conditions:
         * 
         * The above copyright notice and this permission notice shall be included in all
         * copies or substantial portions of the Software.
         * 
         * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
         * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
         * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
         * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
         * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
         * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
         * SOFTWARE.
         */
        class AddCssTimeModyfier {
            constructor() {
                var that = this;
                $(document).ready(
                    function() {
                        that.init();
                    }
                );
            }
            init() {
                this.sourceCorrect = false;
                this.addsCorrect   = false;
                this.cssFxCorrect  = false;
                
                this.cssTMObj      = false;
                this.jsonObj       = false;

                this.checkForm();
                this.textareaColor();
                $("#mainForm").change();
            }
            checkForm() {
                var that = this;
                $("#mainForm").on("keyup change paste",function() {
                    var obj;
                    console.clear();
                    try {
                        eval("obj = {" + $(".leftSide .sourceCode").val() + "}");
                        if (Object.keys(obj).length > 0) {
                            that.cssTMObj = obj;
                            that.sourceCorrect = true
                            if (!that.checkMandatories(obj)) {
                                that.sourceCorrect = false;
                            } else {
                                var cfxi = that.checkFxInput();
                                if (cfxi != true) {
                                    console.error("[RPlayer:cssKey]",cfxi);
                                    that.cssFxCorrect = false;
                                } else {
                                    that.cssFxCorrect = true;
                                    var aci = that.checkAddCode();
                                        if (aci != true) {
                                        console.error("[RPlayer:addCode]",aci);
                                        that.addsCorrect = false;
                                    } else {
                                        var aci = that.checkAddCode();
                                        that.addsCorrect = true;
                                        console.info("[RPlayer:AddCssTimeModyfier]","Great! Everything looks good. ;-)");
                                    }
                                }
                            }
                        } else {
                            that.sourceCorrect = false
                            that.cssTMObj      = false;
                            console.error("[RPlayer:cssTimeModyfier]","Nothing here.")
                        }
                    } catch (error) {
                        that.sourceCorrect = false;
                        console.error("[RPlayer:cssTimeModyfier]","Syntax error.")
                    }
                    that.textareaColor()
                });
            }
            checkAddCode() {
                if ($(".addCode").val() == "") {
                    return "JSON for additing must be set.";
                } else {
                    try {
                        this.jsonObj = JSON.parse($(".addCode").val());
                        return true;
                    } catch (error) {
                        return "Syntax error.";
                    }
                }
            }
            checkFxInput() {
                if ($(".cssFx").val() == "") {
                    return "CSS key must be set.";
                } else {
                    var fxEntries = 0;
                    for (const [key, value] of Object.entries(this.cssTMObj.cssTimeModyfier.css)) {
                        if (key == $(".cssFx").val()) {
                            fxEntries += 1;
                        }
                    }
                    if (fxEntries < 1) {
                        return "No fx entry in cssTimeModyfier object.";
                    } else {
                        return true;
                    }
                }
            }
            checkMandatories(obj) {
                var obj;
                var ret = true;

                if (obj.cssTimeModyfier === undefined) {
                    ret = false;
                    console.error("[RPlayer:cssTimeModyfier]","Node cssTimeModyfier not found.");
                } else {
                    if (obj.cssTimeModyfier.selectors === undefined) {
                        ret = false;
                        console.error("[RPlayer:cssTimeModyfier]","Node cssTimeModyfier.selectors not found.");
                    } else {
                        if (obj.cssTimeModyfier.css === undefined) {
                            ret = false;
                            console.error("[RPlayer:cssTimeModyfier]","Node cssTimeModyfier.css not found.");
                        } else {
                            if (obj.cssTimeModyfier.default === undefined) {
                                ret = false;
                                console.error("[RPlayer:cssTimeModyfier]","Node cssTimeModyfier.default not found.");
                            } else {
                                if (obj.cssTimeModyfier.commandsInTime === undefined) {
                                    ret = false;
                                    console.error("[RPlayer:cssTimeModyfier]","Node cssTimeModyfier.commandsInTime not found.");
                                }
                            }
                        }
                    }
                }

                return ret;
            }
            textareaColor() {
                var that = this;
                setInterval(function() {
                    // source
                    if (that.sourceCorrect) {
                        $(".leftSide .sourceCode").css({
                            borderColor: "lightgreen"
                        });
                    } else {
                        $(".leftSide .sourceCode").css({
                            borderColor: "red"
                        });
                    }
                    // CSS fx
                    if (that.cssFxCorrect) {
                        $(".middleSide .cssFx").css({
                            borderColor: "lightgreen"
                        });
                    } else {
                        $(".middleSide .cssFx").css({
                            borderColor: "red"
                        });
                    }
                    // addCode
                    if (that.addsCorrect) {
                        $(".rightSide .addCode").css({
                            borderColor: "lightgreen"
                        });
                    } else {
                        $(".rightSide .addCode").css({
                            borderColor: "red"
                        });
                    }
                },200);
            }
        }
        new AddCssTimeModyfier();
    </script>
</html>